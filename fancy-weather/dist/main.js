!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const r=new class{changeDate(e,t){e>=0&&e<=1||11===e?this.season="winter":e>=2&&e<=4?this.season="spring":e>=5&&e<=7?this.season="summer":e>=8&&e<=10&&(this.season="autumn"),t>=0&&t<=5?this.timeOfDay="night":t>=6&&t<=11?this.timeOfDay="morning":t>=12&&t<=17?this.timeOfDay="noon":t>=18&&t<=23&&(this.timeOfDay="evening")}};class n{constructor(e){document.body.insertAdjacentHTML("afterbegin",`\n      <div class="preloader-container">\n        <h3 class="preloader-span">Load ${e}...</h3>\n        <span class="loader"></span>\n      </div>\n    `)}removePreloader(){document.querySelector(".preloader-container").remove()}}class s{constructor(e){document.body.insertAdjacentHTML("beforeend",`\n      <div class="alert alert-danger" role="alert">\n        ${e}\n      </div>\n    `)}}class i{constructor(e){this.background=document.createElement("div"),this.background.setAttribute("class","background"),this.setBackgroundStyles(e),document.body.appendChild(this.background);const t=document.createElement("div");t.setAttribute("class","background-darken"),document.body.appendChild(t)}async refreshBackground(){await function(){const{season:e}=r,{timeOfDay:t}=r;let{summary:a}=r.weather.currently;a=a.split(" ").join("_").toLowerCase();const{country:i}=r,{city:c}=r,o=`https://api.unsplash.com/photos/random?${`query=${a},${e},${t},${c},${i}`}&client_id=ee22bffa642d544ceadcdd614c02e1fecb709345dc4bbee0be667788c7555c5b`,l=new n("image");return fetch(o,{headers:{"Access-Control-Allow-Origin":"*"}}).then(e=>e.json()).then(e=>{localStorage.setItem("savedLink",e.urls.small),r.background=e.urls.small,l.removePreloader()}).catch(()=>{l.removePreloader(),r.background=localStorage.savedLink;new s("Sorry but we have to load previously saved image")})}(),this.newImg=r.background,this.setBackgroundStyles(this.newImg)}setBackgroundStyles(e){this.background.style.width="100%",this.background.style.height="100vh",this.background.style.background=`url("${e}") no-repeat`,this.background.style.backgroundPosition="center",this.background.style.backgroundSize="cover"}}async function c(){const e=r.latitude,t=r.longitude;return fetch("https://cors-anywhere.herokuapp.com/"+`https://api.darksky.net/forecast/d8563055b51df9f6d5d4e5e6093857fb/${`${e},${t}`}?units=si`).then(e=>e.json()).then(e=>(r.weather=e,e)).catch(()=>{new s("Sorry, but you've made too many requests")})}class o{constructor(e,t){switch(t){case"clear-day":e.insertAdjacentHTML("beforeend",'<i class="fas fa-sun weather-icon"></i>');break;case"clear-night":e.insertAdjacentHTML("beforeend",'<i class="fas fa-moon weather-icon"></i>');break;case"partly-cloudy-day":e.insertAdjacentHTML("beforeend",'<i class="fas fa-cloud-sun weather-icon"></i>');break;case"partly-cloudy-night":e.insertAdjacentHTML("beforeend",'<i class="fas fa-cloud-moon weather-icon"></i>');break;case"cloudy":e.insertAdjacentHTML("beforeend",'<i class="fas fa-cloud weather-icon"></i>');break;case"rain":e.insertAdjacentHTML("beforeend",'<i class="fas fa-cloud-showers-heavy weather-icon"></i>');break;case"sleet":e.insertAdjacentHTML("beforeend",'<i class="fas fa-cloud-meatball weather-icon"></i>');break;case"snow":e.insertAdjacentHTML("beforeend",'<i class="far fa-snowflake weather-icon"></i>');break;case"wind":e.insertAdjacentHTML("beforeend",'<i class="fas fa-wind weather-icon"></i>');break;case"fog":e.insertAdjacentHTML("beforeend",'<i class="fas fa-smog weather-icon"></i>')}}}function l(){const e=(new Date).getTime(),t=(new Date).getTimezoneOffset(),a=new Date(e+6e4*t+r.GMTdifference),n=a.getDay();r.day=n;const s=a.getMonth();let i=a.getHours();r.changeDate(s,i);let c=a.getMinutes();i/10<1&&(i=`0${i}`),c/10<1&&(c=`0${c}`);return`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n]} ${a.getDate()} ${["January","February","March","April","May","June","July","August","September","October","November","December"][s]} ${i}:${c}`}class d{constructor(e){this.weather=e,this.currentWeatherBlock=document.createElement("div"),this.currentCityBlock=document.createElement("div"),this.currentWeatherTempBlock=document.createElement("div"),this.currentWeatherBlockComplex=document.createElement("div"),this.currentCity=document.createElement("p"),this.currentDate=document.createElement("p"),this.currentWeather=document.createElement("p"),this.currentWeatherBlock.setAttribute("class","current-weather-block"),document.body.appendChild(this.currentWeatherBlock),this.currentWeatherBlock.appendChild(this.currentCityBlock),this.currentCityBlock.setAttribute("class","current-weather-block_city"),this.currentWeatherBlock.appendChild(this.currentWeatherTempBlock),this.currentWeatherTempBlock.setAttribute("class","current-weather-block_temp"),this.currentWeatherBlock.appendChild(this.currentWeatherBlockComplex),this.currentWeatherBlockComplex.setAttribute("class","current-weather-block_complex-data"),this.currentCity.setAttribute("class","current-city"),this.currentCity.innerHTML=`${r.city}, ${r.country}`,this.currentCityBlock.appendChild(this.currentCity),this.currentDate.setAttribute("class","current-date"),this.currentCityBlock.appendChild(this.currentDate),this.currentWeather.setAttribute("class","current-weather"),this.currentWeather.innerHTML=`${Math.ceil(this.weather.currently.temperature)} &degС`,this.currentWeatherTempBlock.appendChild(this.currentWeather);new o(this.currentWeatherTempBlock,this.weather.currently.icon);this.currentWeatherBlockComplex.insertAdjacentHTML("afterbegin",`\n      <p class="current-weather-block_complex-data_str summary">${this.weather.currently.summary}</p>\n      <p class="current-weather-block_complex-data_str apparent">Feels like: ${Math.ceil(this.weather.currently.apparentTemperature)} &degС</p>\n      <p class="current-weather-block_complex-data_str windSpeed">Wind speed: ${this.weather.currently.windSpeed} m/s</p>\n      <p class="current-weather-block_complex-data_str humidity">Humidity: ${100*this.weather.currently.humidity}%</p>\n    `)}refreshTime(){const e=l();document.querySelector(".current-date").innerHTML=e,setInterval(this.refreshTime,1e3)}changeUnitsToFahrenheit(){this.currentWeather.innerHTML=`${Math.ceil(1.8*this.weather.currently.temperature+32)} &degF`,document.querySelector(".apparent").innerHTML=`Feels like: ${Math.ceil(1.8*this.weather.currently.apparentTemperature+32)} &degF`}changeUnitsToCelsius(){this.currentWeather.innerHTML=`${Math.ceil(this.weather.currently.temperature)} &degС`,document.querySelector(".apparent").innerHTML=`Feels like: ${Math.ceil(this.weather.currently.apparentTemperature)} &degС`}refreshCurrentWeather(e){this.weather=e,this.currentWeather.innerHTML=`${Math.ceil(this.weather.currently.temperature)} &degС`,this.currentCity.innerHTML=`${r.city}, ${r.country}`,document.querySelector(".summary").innerHTML=`${this.weather.currently.summary}`,document.querySelector(".apparent").innerHTML=`Feels like: ${Math.ceil(this.weather.currently.apparentTemperature)} &degС`,document.querySelector(".windSpeed").innerHTML=`Wind speed: ${this.weather.currently.windSpeed} m/s`,document.querySelector(".humidity").innerHTML=`Humidity: ${100*this.weather.currently.humidity}%`}}class u{constructor(){this.weather=r.weather,this.dailyWeatherBlock=document.createElement("div"),this.dailyWeatherBlock.setAttribute("class","daily-weather-block"),document.body.appendChild(this.dailyWeatherBlock),this.day=r.day,this.daysMatrix=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}addNewDate(e,t){this.dailyWeatherData=document.createElement("div"),this.dailyWeatherData.setAttribute("class","daily-weather-block_data"),this.dailyWeatherBlock.appendChild(this.dailyWeatherData),this.dailyWeatherDay=document.createElement("p"),this.dailyWeatherDay.setAttribute("class","daily-weather-block_data__day"),this.nextDay=this.day+t,this.nextDay>6&&(this.nextDay=this.day+t-7),this.dailyWeatherDay.innerHTML=`${this.daysMatrix[this.nextDay]}`,this.dailyWeatherData.appendChild(this.dailyWeatherDay),this.dailyWeatherTemp=document.createElement("p"),this.dailyWeatherTemp.setAttribute("class","daily-weather-block_data__temp"),this.dailyWeatherTemp.innerHTML=`${Math.round(e.temperatureMax)} &degС / ${Math.round(e.temperatureMin)} &degС`,this.dailyWeatherData.appendChild(this.dailyWeatherTemp);new o(this.dailyWeatherData,e.icon)}switchUnitsToFahrenheit(){const e=document.querySelectorAll(".daily-weather-block_data__temp");this.weatherData=r.weather.daily.data;let t=1;e.forEach(e=>{e.innerHTML=`${Math.round(1.8*this.weatherData[t].temperatureMax+32)} &degF / ${Math.round(1.8*this.weatherData[t].temperatureMin+32)} &degF`,t+=1})}switchUnitsToCelsius(){const e=document.querySelectorAll(".daily-weather-block_data__temp");this.weatherData=r.weather.daily.data;let t=1;e.forEach(e=>{e.innerHTML=`${Math.round(this.weatherData[t].temperatureMax)} &degС / ${Math.round(this.weatherData[t].temperatureMin)} &degС`,t+=1})}refreshCurrentWeather(){const e=document.querySelectorAll(".daily-weather-block_data__temp");this.temperature=r.weather.daily;let t=1;e.forEach(e=>{e.innerHTML=`${Math.round(this.temperature.data[t].temperatureMax)} &degС / ${Math.round(this.temperature.data[t].temperatureMin)} &degС`,t+=1}),t=1,this.day=r.day,document.querySelectorAll(".daily-weather-block_data__day").forEach(e=>{this.nextDay=this.day+t,this.nextDay>6&&(this.nextDay=this.day+t-7),e.innerHTML=`${this.daysMatrix[this.nextDay]}`,t+=1})}}class h{constructor(e,t){this.long=e,this.lat=t,document.body.insertAdjacentHTML("beforeend","\n    <div class=\"map-wrapper\">\n      <div id='map' style='width: 400px; height: 300px;'></div>\n      <div class='coordinates-container'>\n        <p class=\"coordinates longitude\"></p>\n        <p class=\"coordinates latitude\"></p>\n      </div>\n    </div>\n  "),this.refreshLatLng(e,t)}drawMap(e,t){mapboxgl.accessToken="pk.eyJ1IjoibWF4ZGFuaWxvdiIsImEiOiJjazNkYWJpdmUxNDRsM21xdDJ4OGQ0cnp3In0.ZUQD9jZOgJDQDBfIOC_r7A";new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[e,t],zoom:9})}refreshLatLng(e,t){this.long=`${(+e).toFixed(2)}`,this.lat=`${(+t).toFixed(2)}`,this.longDeg=`${Math.trunc(this.long)}&deg`,this.longMin=`${Math.trunc(100*Math.abs(Math.trunc(this.long)-this.long).toFixed(2))}'`,this.latDeg=`${Math.trunc(this.lat)}&deg`,this.latMin=`${Math.trunc(100*Math.abs(Math.trunc(this.lat)-this.lat).toFixed(2))}'`,2===this.latMin.length&&(this.latMin=`0${this.latMin}`),2===this.longMin.length&&(this.longMin=`0${this.longMin}`);const a=document.querySelector(".longitude"),r=document.querySelector(".latitude");a.innerHTML=`Longitude: ${this.longDeg} ${this.longMin}`,r.innerHTML=`Latitude: ${this.latDeg} ${this.latMin}`}}class p{constructor(){this.navbar='\n    <nav class="navigation">\n      <div class="btns-wrapper">\n      <button type="button" class="btn btn-secondary refresh-btn"><i class="fas fa-sync-alt"></i></button>\n      <div class="dropdown">\n          <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n            Language\n          </button>\n          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">\n            <a class="dropdown-item en-lang" href="#">English</a>\n            <a class="dropdown-item bel-lang" href="#">Belarusian</a>\n            <a class="dropdown-item rus-lang" href="#">Russian</a>\n          </div>\n          </div>\n          <div class="btn-group btn-group-toggle" data-toggle="buttons">\n          <label class="btn btn-secondary active temp-tumbler temp-celsius">\n            <input type="radio" name="options" id="option1" autocomplete="off" checked> &degC\n          </label>\n          <label class="btn btn-secondary temp-tumbler temp-fahrenheit">\n            <input type="radio" name="options" id="option2" autocomplete="off"> &degF\n          </label>\n        </div>\n        </div>\n        <div class="input-group mb-3">\n          <input type="text" class="form-control search-input" placeholder="Search" aria-label="Search" aria-describedby="button-addon2">\n          <span class="voice-btn">\n            <i class="fas fa-microphone"></i>\n          </span>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary search-btn" type="button" id="button-addon2"><i class="fas fa-search"></i></button>\n          </div>\n        </div>\n    </nav>',document.querySelector(".background-darken").insertAdjacentHTML("afterend",this.navbar)}}function y(){const{city:e}=r,t=`https://api.opencagedata.com/geocode/v1/json?q=${e}&key=c6b6da0f80f24b299e08ee1075f81aa5&pretty=1&language=en-US`,a=new n("location");return fetch(t).then(e=>e.json()).then(e=>(r.GMTdifference=1e3*e.results[0].annotations.timezone.offset_sec,r.latitude=e.results[0].geometry.lat.toFixed(4),r.longitude=e.results[0].geometry.lng.toFixed(4),r.country=e.results[0].components.country,a.removePreloader(),e)).catch(()=>{new s("Oops! Something went wrong!")})}function m(e){switch(e){case"cel":localStorage.setItem("activeTemp","cel");break;case"fahr":localStorage.setItem("activeTemp","fahr");break;default:return null}return null}localStorage.activeTemp||localStorage.setItem("activeTemp","cel"),async function(){await async function(){return fetch("https://ipinfo.io/json?token=86d5efd448469d").then(e=>e.json()).then(e=>(r.city=e.city,e)).catch(()=>{new s("Oops! Something went wrong!")})}(),await y(),await c(),l(),await function(){const{season:e}=r,{timeOfDay:t}=r;let{summary:a}=r.weather.currently;a=a.split(" ").join("_").toLowerCase();const{country:i}=r,{city:c}=r,o=`https://api.unsplash.com/photos/random?${`query=${a},${e},${t},${c},${i}`}&client_id=ee22bffa642d544ceadcdd614c02e1fecb709345dc4bbee0be667788c7555c5b`,l=new n("image");return fetch(o,{headers:{"Access-Control-Allow-Origin":"*"}}).then(e=>e.json()).then(e=>{localStorage.setItem("savedLink",e.urls.small),r.background=e.urls.small,l.removePreloader()}).catch(()=>{l.removePreloader(),r.background=localStorage.savedLink;new s("Sorry but we have to load previously saved image")})}();const e=new i(r.background),t=(new p,new d(r.weather));t.refreshTime();const a=new u;for(let e=1;e<4;e+=1)a.addNewDate(r.weather.daily.data[e],e);const b=new h(r.longitude,r.latitude);function g(){switch(localStorage.activeTemp){case"cel":t.changeUnitsToCelsius(),a.switchUnitsToCelsius(),document.querySelector(".temp-celsius").classList.add("active"),document.querySelector(".temp-fahrenheit").classList.remove("active");break;case"fahr":t.changeUnitsToFahrenheit(),a.switchUnitsToFahrenheit(),document.querySelector(".temp-fahrenheit").classList.add("active"),document.querySelector(".temp-celsius").classList.remove("active");break;default:return null}return null}async function f(){r.city=document.querySelector(".search-input").value,await y(),await c(),l(),console.log(r),e.refreshBackground(),t.refreshCurrentWeather(r.weather),a.refreshCurrentWeather(),g(),b.drawMap(r.longitude,r.latitude),b.refreshLatLng(r.longitude,r.latitude),document.querySelectorAll(".weather-icon").forEach(e=>{e.remove()});const n=document.querySelector(".current-weather-block_temp"),s=r.weather.currently.icon;new o(n,s);let i=1;document.querySelectorAll(".daily-weather-block_data").forEach(e=>{const{icon:t}=r.weather.daily.data[i];new o(e,t);i+=1})}b.drawMap(r.longitude,r.latitude),document.querySelector(".refresh-btn").addEventListener("click",()=>{e.refreshBackground()}),document.querySelectorAll(".temp-tumbler").forEach(e=>{e.addEventListener("click",()=>{e.classList.contains("temp-celsius")&&(t.changeUnitsToCelsius(),a.switchUnitsToCelsius(),m("cel")),e.classList.contains("temp-fahrenheit")&&(t.changeUnitsToFahrenheit(),a.switchUnitsToFahrenheit(),m("fahr"))})}),g(),document.querySelector(".voice-btn").addEventListener("click",()=>{!function(){const e=new webkitSpeechRecognition;e.interimResults=!1,e.lang="en-US",e.addEventListener("result",e=>{const t=e.results[e.resultIndex];document.querySelector(".search-input").value=t[0].transcript}),e.start()}(),setTimeout(()=>{if(document.querySelector(".search-input").value.length)f();else{new s("Please speak louder!")}},5e3)}),document.querySelector(".search-btn").addEventListener("click",f),document.querySelector(".search-input").addEventListener("keypress",e=>{"Enter"===e.code&&f()}),document.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",()=>{if(!e.classList.contains("en-lang")){new s("Translation feature will be added soon")}})})}()}]);